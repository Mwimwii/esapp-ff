{"ast":null,"code":"import { __awaiter, __generator } from \"tslib\";\nimport { DataService } from '../../services/data-service';\nimport { Store } from '@ngrx/store';\nimport { NzMessageService } from 'ng-zorro-antd/message';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"ng-zorro-antd/message\";\nimport * as i2 from \"../../services/data-service\";\nimport * as i3 from \"@ngrx/store\";\n\nfunction FaabsComponent_nz_tab_7_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"nz-tab\", 13);\n    i0.ɵɵelement(1, \"app-faabs-tab\", 14);\n    i0.ɵɵelementStart(2, \"div\", 15)(3, \"div\", 16)(4, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function FaabsComponent_nz_tab_7_Template_button_click_4_listener() {\n      var restoredCtx = i0.ɵɵrestoreView(_r6);\n      var faab_r4 = restoredCtx.$implicit;\n      var ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.showTopicsModal(faab_r4.id);\n    });\n    i0.ɵɵtext(5, \"Show Topics\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 16)(7, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function FaabsComponent_nz_tab_7_Template_button_click_7_listener() {\n      var restoredCtx = i0.ɵɵrestoreView(_r6);\n      var faab_r4 = restoredCtx.$implicit;\n      var ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.showAttendanceModal(faab_r4.id);\n    });\n    i0.ɵɵtext(8, \"Attendance\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 16)(10, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function FaabsComponent_nz_tab_7_Template_button_click_10_listener() {\n      var restoredCtx = i0.ɵɵrestoreView(_r6);\n      var faab_r4 = restoredCtx.$implicit;\n      var ctx_r8 = i0.ɵɵnextContext();\n      return ctx_r8.showPastAttendanceModal(faab_r4.id);\n    });\n    i0.ɵɵtext(11, \"Show Attendance\");\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    var faab_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"nzTitle\", faab_r4.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"faabs_id\", faab_r4.id);\n  }\n}\n\nfunction FaabsComponent_ng_container_11_ul_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\")(1, \"li\")(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    var enrollment_r10 = ctx.$implicit;\n    var ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r9.faabsTopics[enrollment_r10.topic_id].topic);\n  }\n}\n\nfunction FaabsComponent_ng_container_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, FaabsComponent_ng_container_11_ul_1_Template, 4, 1, \"ul\", 18);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.faabsTopicsEnrollmentsFiltered);\n  }\n}\n\nfunction FaabsComponent_ng_container_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1);\n    i0.ɵɵelement(2, \"app-register-attendants-form\", 19);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.faabsIDSelected, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"faabsGroupsId\", ctx_r2.faabsIDSelected);\n  }\n}\n\nfunction FaabsComponent_ng_container_17_ul_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\")(1, \"li\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"json\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    var faabsAttendance_r12 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 1, faabsAttendance_r12));\n  }\n}\n\nfunction FaabsComponent_ng_container_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, FaabsComponent_ng_container_17_ul_1_Template, 4, 3, \"ul\", 18);\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.faabsAttendanceRegisterFiltered);\n  }\n}\n\nvar FaabsComponent =\n/** @class */\nfunction () {\n  function FaabsComponent(message, http, store) {\n    this.message = message;\n    this.http = http;\n    this.store = store;\n    this.isTopicsVisible = false;\n    this.isAttendanceVisible = false;\n    this.isPastAttendanceVisible = false;\n    this.loading = true;\n  } //Get the faabs groups\n  // Get the faabs topics and set their id as the key of the object\n\n\n  FaabsComponent.prototype.ngOnInit = function () {\n    var _this = this;\n\n    this.faabs = this.http.getFaabsGroups();\n    this.http.getFaabsTopics().subscribe(function (data) {\n      _this.faabsTopics = _this.arrayToObj(data, 'id');\n    });\n    this.loading = false;\n    this.http.getFaabsAttendanceRegister() // .subscribe((data: any[]) => this.faabsAttendanceRegister = this.arrayToObj(data.map((item: FaabsAttendance) => {return {...item, key: item.topic+item.created_at+item.faabs_group_id }}), 'id'));\n    .subscribe(function (data) {\n      return _this.faabsAttendanceRegister = data;\n    });\n  };\n\n  FaabsComponent.prototype.arrayToObj = function (data, key) {\n    return data.reduce(function (acc, curr) {\n      return acc[curr[key]] = curr, acc;\n    }, {});\n  };\n\n  FaabsComponent.prototype.arrayToObjOfArrays = function (data, key) {\n    return data.reduce(function (acc, curr) {\n      return acc[curr[key]] = curr, acc;\n    }, []);\n  };\n\n  FaabsComponent.prototype.getFaabsTopics = function (faabsID) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _this = this;\n\n      return __generator(this, function (_a) {\n        this.http.getFaabsTopicsEnrollments().subscribe(function (data) {\n          _this.faabsTopicsEnrollmentsFiltered = data.filter(function (topic) {\n            return (topic === null || topic === void 0 ? void 0 : topic.faabs_id) === faabsID;\n          });\n        });\n        return [2\n        /*return*/\n        ];\n      });\n    });\n  };\n\n  FaabsComponent.prototype.showTopicsModal = function (faabsID) {\n    this.isTopicsVisible = true;\n    this.getFaabsTopics(faabsID);\n  };\n\n  FaabsComponent.prototype.showAttendanceModal = function (faabsID) {\n    this.isAttendanceVisible = true;\n    this.faabsIDSelected = faabsID;\n  };\n\n  FaabsComponent.prototype.showPastAttendanceModal = function (faabsID) {\n    var _this = this;\n\n    this.isPastAttendanceVisible = true;\n    this.faabsIDSelected = faabsID;\n    this.faabsAttendanceRegisterFiltered = this.faabsAttendanceRegister.filter(function (data) {\n      return _this.faabsIDSelected === data.faabs_group_id;\n    });\n    console.log(this.faabsAttendanceRegister.map(function (data) {\n      return {\n        id: data.faabs_group_id\n      };\n    }));\n  };\n\n  FaabsComponent.prototype.handleCancel = function () {\n    this.isTopicsVisible = false;\n    this.isAttendanceVisible = false;\n    this.isPastAttendanceVisible = false;\n  };\n\n  FaabsComponent.prototype.handleTopicsOk = function () {\n    this.isTopicsVisible = false;\n  };\n\n  FaabsComponent.prototype.handleAttendanceOk = function () {\n    this.isAttendanceVisible = false;\n    this.faabsIDSelected = 0;\n  };\n\n  FaabsComponent.prototype.handlePastAttendanceOk = function () {\n    this.isPastAttendanceVisible = false;\n    this.faabsIDSelected = 0;\n  };\n\n  FaabsComponent.ɵfac = function FaabsComponent_Factory(t) {\n    return new (t || FaabsComponent)(i0.ɵɵdirectiveInject(i1.NzMessageService), i0.ɵɵdirectiveInject(i2.DataService), i0.ɵɵdirectiveInject(i3.Store));\n  };\n\n  FaabsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: FaabsComponent,\n    selectors: [[\"app-faabs\"]],\n    decls: 18,\n    vars: 6,\n    consts: [[1, \"row\"], [1, \"col-lg-12\"], [1, \"card\", \"card-top\", \"card-top-primary\"], [1, \"card-header\"], [\"nzType\", \"card\"], [3, \"nzTitle\", 4, \"ngFor\", \"ngForOf\"], [\"name\", \"topics-modal\"], [\"nzTitle\", \"Topics Enrolled\", 3, \"nzVisible\", \"nzVisibleChange\", \"nzOnCancel\", \"nzOnOk\"], [4, \"nzModalContent\"], [\"name\", \"attendance-modal\"], [\"nzTitle\", \"Attendance Sheet\", 3, \"nzVisible\", \"nzVisibleChange\", \"nzOnCancel\", \"nzOnOk\"], [\"name\", \"past-attendance-modal\"], [\"nzTitle\", \"Past Attendance\", 3, \"nzVisible\", \"nzVisibleChange\", \"nzOnCancel\", \"nzOnOk\"], [3, \"nzTitle\"], [3, \"faabs_id\"], [1, \"row\", \"ml-4\"], [1, \"mx-1\", 2, \"margin-bottom\", \"8px\"], [\"nz-button\", \"\", 3, \"click\"], [4, \"ngFor\", \"ngForOf\"], [3, \"faabsGroupsId\"]],\n    template: function FaabsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\")(1, \"div\", 0)(2, \"div\", 1)(3, \"div\", 2)(4, \"div\", 3)(5, \"div\")(6, \"nz-tabset\", 4);\n        i0.ɵɵtemplate(7, FaabsComponent_nz_tab_7_Template, 12, 2, \"nz-tab\", 5);\n        i0.ɵɵpipe(8, \"async\");\n        i0.ɵɵelementEnd()()()()()();\n        i0.ɵɵelementStart(9, \"div\", 6)(10, \"nz-modal\", 7);\n        i0.ɵɵlistener(\"nzVisibleChange\", function FaabsComponent_Template_nz_modal_nzVisibleChange_10_listener($event) {\n          return ctx.isTopicsVisible = $event;\n        })(\"nzOnCancel\", function FaabsComponent_Template_nz_modal_nzOnCancel_10_listener() {\n          return ctx.handleCancel();\n        })(\"nzOnOk\", function FaabsComponent_Template_nz_modal_nzOnOk_10_listener() {\n          return ctx.handleTopicsOk();\n        });\n        i0.ɵɵtemplate(11, FaabsComponent_ng_container_11_Template, 2, 1, \"ng-container\", 8);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(12, \"div\", 9)(13, \"nz-modal\", 10);\n        i0.ɵɵlistener(\"nzVisibleChange\", function FaabsComponent_Template_nz_modal_nzVisibleChange_13_listener($event) {\n          return ctx.isAttendanceVisible = $event;\n        })(\"nzOnCancel\", function FaabsComponent_Template_nz_modal_nzOnCancel_13_listener() {\n          return ctx.handleCancel();\n        })(\"nzOnOk\", function FaabsComponent_Template_nz_modal_nzOnOk_13_listener() {\n          return ctx.handleAttendanceOk();\n        });\n        i0.ɵɵtemplate(14, FaabsComponent_ng_container_14_Template, 3, 2, \"ng-container\", 8);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(15, \"div\", 11)(16, \"nz-modal\", 12);\n        i0.ɵɵlistener(\"nzVisibleChange\", function FaabsComponent_Template_nz_modal_nzVisibleChange_16_listener($event) {\n          return ctx.isPastAttendanceVisible = $event;\n        })(\"nzOnCancel\", function FaabsComponent_Template_nz_modal_nzOnCancel_16_listener() {\n          return ctx.handleCancel();\n        })(\"nzOnOk\", function FaabsComponent_Template_nz_modal_nzOnOk_16_listener() {\n          return ctx.handlePastAttendanceOk();\n        });\n        i0.ɵɵtemplate(17, FaabsComponent_ng_container_17_Template, 2, 1, \"ng-container\", 8);\n        i0.ɵɵelementEnd()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(8, 4, ctx.faabs));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"nzVisible\", ctx.isTopicsVisible);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"nzVisible\", ctx.isAttendanceVisible);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"nzVisible\", ctx.isPastAttendanceVisible);\n      }\n    },\n    encapsulation: 2\n  });\n  return FaabsComponent;\n}();\n\nexport { FaabsComponent };","map":null,"metadata":{},"sourceType":"module"}