{"ast":null,"code":"import _defineProperty from \"C:\\\\Users\\\\admin\\\\Documents\\\\work\\\\ESAPP\\\\esapp-mobile\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\defineProperty.js\";\nimport _classCallCheck from \"C:\\\\Users\\\\admin\\\\Documents\\\\work\\\\ESAPP\\\\esapp-mobile\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\classCallCheck.js\";\nimport _createClass from \"C:\\\\Users\\\\admin\\\\Documents\\\\work\\\\ESAPP\\\\esapp-mobile\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createClass.js\";\nimport { __decorate, __metadata } from \"tslib\";\nimport __NG_CLI_RESOURCE__0 from \"./menu-top.component.html?ngResource\";\nimport __NG_CLI_RESOURCE__1 from \"./menu-top.component.scss?ngResource\";\nimport { Component } from '@angular/core';\nimport { Router, NavigationStart } from '@angular/router';\nimport { filter } from 'rxjs/operators';\nimport { transition, trigger, style, animate } from '@angular/animations';\nimport * as _ from 'lodash';\nimport { select, Store } from '@ngrx/store';\nimport { MenuService } from 'src/app/services/menu';\nimport * as SettingsActions from 'src/app/store/settings/actions';\nimport * as Reducers from 'src/app/store/reducers';\n\nvar MenuFlyoutTopComponent = /*#__PURE__*/function () {\n  function MenuFlyoutTopComponent(menuService, store, router) {\n    _classCallCheck(this, MenuFlyoutTopComponent);\n\n    this.menuService = menuService;\n    this.store = store;\n    this.router = router;\n    this.menuData = [];\n    this.activeSubmenu = '';\n    this.activeItem = '';\n    this.renderedFlyoutItems = {};\n    this.flyoutTimers = {};\n    this.flyoutActive = false;\n    this.objectKeys = Object.keys;\n  }\n\n  _createClass(MenuFlyoutTopComponent, [{\n    key: \"ngOnInit\",\n    value: function ngOnInit() {\n      var _this = this;\n\n      this.menuService.getMenuData().subscribe(function (menuData) {\n        return _this.menuData = menuData;\n      });\n      this.store.pipe(select(Reducers.getSettings)).subscribe(function (state) {\n        _this.logo = state.logo;\n        _this.version = state.version;\n        _this.description = state.description;\n        _this.isMobileView = state.isMobileView;\n        _this.isMobileMenuOpen = state.isMobileMenuOpen;\n        _this.isMenuCollapsed = state.isMenuCollapsed;\n        _this.isMenuUnfixed = state.isMenuUnfixed;\n        _this.isMenuShadow = state.isMenuShadow;\n        _this.menuType = state.menuType;\n        _this.menuColor = state.menuColor;\n        _this.flyoutMenuColor = state.flyoutMenuColor;\n        _this.menuLayoutType = state.menuLayoutType;\n        _this.isSidebarOpen = state.isSidebarOpen;\n        _this.flyoutActive = !state.isMobileView;\n      });\n      this.setActiveItems(this.router.url);\n      this.router.events.pipe(filter(function (event) {\n        return event instanceof NavigationStart;\n      })).subscribe(function (event) {\n        _this.setActiveItems(event.url ? event.url : null);\n      });\n    }\n  }, {\n    key: \"toggleMobileMenu\",\n    value: function toggleMobileMenu() {\n      this.store.dispatch(new SettingsActions.SetStateAction({\n        isMobileMenuOpen: !this.isMobileMenuOpen\n      }));\n    }\n  }, {\n    key: \"toggleMenu\",\n    value: function toggleMenu() {\n      this.store.dispatch(new SettingsActions.SetStateAction({\n        isMenuCollapsed: !this.isMenuCollapsed\n      }));\n    }\n  }, {\n    key: \"toggleSettings\",\n    value: function toggleSettings() {\n      this.store.dispatch(new SettingsActions.SetStateAction({\n        isSidebarOpen: !this.isSidebarOpen\n      }));\n    }\n  }, {\n    key: \"handleSubmenuClick\",\n    value: function handleSubmenuClick(key) {\n      var currentKey = this.activeSubmenu;\n\n      if (this.flyoutActive) {\n        return;\n      }\n\n      this.activeSubmenu = currentKey === key ? '' : key;\n    }\n  }, {\n    key: \"setActiveItems\",\n    value: function setActiveItems(pathname) {\n      var menuData = this.menuData;\n\n      var flattenItems = function flattenItems(items, key) {\n        return items.reduce(function (flattenedItems, item) {\n          flattenedItems.push(item);\n\n          if (Array.isArray(item[key])) {\n            return flattenedItems.concat(flattenItems(item[key], key));\n          }\n\n          return flattenedItems;\n        }, []);\n      };\n\n      var activeItem = _.find(flattenItems(menuData, 'children'), ['url', pathname]) || {};\n      var activeSubmenu = menuData.reduce(function (key, parent) {\n        if (Array.isArray(parent.children)) {\n          parent.children.map(function (child) {\n            if (child.key === activeItem.key) {\n              key = parent;\n            }\n\n            return '';\n          });\n        }\n\n        return key;\n      });\n      this.activeItem = activeItem.key;\n      this.activeSubmenu = activeSubmenu.key;\n    }\n  }, {\n    key: \"handleFlyoutOver\",\n    value: function handleFlyoutOver(event, key, items) {\n      if (this.flyoutActive) {\n        clearInterval(this.flyoutTimers[key]);\n        var item = event.currentTarget;\n        var itemDimensions = item.getBoundingClientRect();\n        this.renderedFlyoutItems = Object.assign(Object.assign({}, this.renderedFlyoutItems), _defineProperty({}, key, {\n          key: key,\n          itemDimensions: itemDimensions,\n          items: items\n        }));\n      }\n    }\n  }, {\n    key: \"handleFlyoutOut\",\n    value: function handleFlyoutOut(key) {\n      var _this2 = this;\n\n      if (this.flyoutActive) {\n        this.flyoutTimers[key] = setTimeout(function () {\n          var updatedFlyoutItems = Object.assign({}, _this2.renderedFlyoutItems);\n          delete updatedFlyoutItems[key];\n          _this2.renderedFlyoutItems = Object.assign({}, updatedFlyoutItems);\n        }, 100);\n      }\n    }\n  }, {\n    key: \"handleFlyoutContainerOver\",\n    value: function handleFlyoutContainerOver(key) {\n      clearInterval(this.flyoutTimers[key]);\n    }\n  }]);\n\n  return MenuFlyoutTopComponent;\n}();\n\nMenuFlyoutTopComponent.ctorParameters = function () {\n  return [{\n    type: MenuService\n  }, {\n    type: Store\n  }, {\n    type: Router\n  }];\n};\n\nMenuFlyoutTopComponent = __decorate([Component({\n  selector: 'vb-menu-flyout-top',\n  template: __NG_CLI_RESOURCE__0,\n  animations: [trigger('flyoutAnimation', [transition(':enter', [style({\n    transform: 'translate3d(-50%, 20px, 0)'\n  }), animate('100ms ease-in-out', style({\n    transform: 'translate3d(-50%, 0, 0)'\n  }))])])],\n  styles: [__NG_CLI_RESOURCE__1]\n}), __metadata(\"design:paramtypes\", [MenuService, Store, Router])], MenuFlyoutTopComponent);\nexport { MenuFlyoutTopComponent };","map":null,"metadata":{},"sourceType":"module"}